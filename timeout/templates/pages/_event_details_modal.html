{% load static %}

<!-- Event Details Modal -->
<div class="modal fade" id="eventDetailsModal" tabindex="-1" aria-labelledby="eventDetailsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">

      <!-- Modal Header -->
      <div class="modal-header">
        <span class="badge" id="eventBadge" style="font-size:0.9rem;"></span>
        <span class="badge" id="eventVisibilityBadge" style="font-size:0.9rem; margin-left: 0.5rem;"></span>
        <h5 class="modal-title ms-2" id="eventDetailsModalLabel"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body">
        <p class="text-muted mb-3" id="eventTime"></p>

        <div class="row mb-2">
          <div class="col-md-6"><strong>Status:</strong> <span id="eventStatus"></span></div>
          <div class="col-md-6"><strong>Recurrence:</strong> <span id="eventRecurrence"></span></div>
        </div>

        <div class="row mb-2">
          <div class="col-md-6"><strong>All Day Event:</strong> <span id="eventAllDay"></span></div>
          <div class="col-md-6"><strong>Duration:</strong> <span id="eventDuration"></span></div>
        </div>

        <div class="row mb-2">
          <div class="col-md-6"><strong>Ongoing:</strong> <span id="eventOngoing"></span></div>
          <div class="col-md-6"><strong>Past:</strong> <span id="eventPast"></span></div>
        </div>

        <p id="eventLocation"></p>
        <p id="eventDescription"></p>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer">
        <a href="#" class="btn btn-nep text-white" id="editEventBtn">Edit Event</a>
        <a href="#" class="btn btn-danger text-white" id="deleteEventBtn" 
           onclick="return confirm('Are you sure you want to delete this event?');">
          Delete Event
        </a>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>

<!-- JS to populate modal -->
<script>
  const eventDetailsModal = document.getElementById('eventDetailsModal');
  eventDetailsModal.addEventListener('show.bs.modal', function (event) {
    const button = event.relatedTarget;
    const eventId = button.getAttribute('data-event-id');

    // Title & Badges
    document.getElementById('eventDetailsModalLabel').textContent = button.getAttribute('data-event-title');
    const typeBadge = document.getElementById('eventBadge');
    typeBadge.textContent = button.getAttribute('data-event-type');
    typeBadge.style.backgroundColor = button.getAttribute('data-event-color');

    const visibilityBadge = document.getElementById('eventVisibilityBadge');
    const visibility = button.getAttribute('data-event-visibility');
    visibilityBadge.textContent = visibility.charAt(0).toUpperCase() + visibility.slice(1);
    visibilityBadge.className = 'badge ' + (visibility === 'public' ? 'bg-success' : 'bg-secondary');

    // Details
    document.getElementById('eventTime').textContent = button.getAttribute('data-event-start') + ' â€“ ' + button.getAttribute('data-event-end');
    document.getElementById('eventStatus').textContent = button.getAttribute('data-event-status');
    document.getElementById('eventRecurrence').textContent = button.getAttribute('data-event-recurrence');
    document.getElementById('eventAllDay').textContent = button.getAttribute('data-event-all-day');
    document.getElementById('eventDuration').textContent = button.getAttribute('data-event-duration');
    document.getElementById('eventOngoing').textContent = button.getAttribute('data-event-ongoing');
    document.getElementById('eventPast').textContent = button.getAttribute('data-event-past');
    document.getElementById('eventLocation').textContent = button.getAttribute('data-event-location') ? 'Location: ' + button.getAttribute('data-event-location') : '';
    document.getElementById('eventDescription').textContent = button.getAttribute('data-event-description') ? 'Description: ' + button.getAttribute('data-event-description') : '';

    // Links
    document.getElementById('editEventBtn').href = '/event/' + eventId + '/edit/';
    document.getElementById('deleteEventBtn').href = '/event/' + eventId + '/delete/';
  });
</script>